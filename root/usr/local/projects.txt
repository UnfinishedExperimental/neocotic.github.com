<div id="vhs-projects">
    <div class="loader"></div>
    <table style="display: none">
        <thead>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th style="text-align: center"><div alt="Watchers" class="gh-icon-watch" title="Watchers"></div></th>
                <th style="text-align: center"><div alt="Forks" class="gh-icon-fork" title="Forks"></div></th>
                <th style="text-align: center"><div alt="Issues" class="gh-icon-admin" title="Issues"></div></th>
                <th>Created</th>
                <th>Updated</th>
            </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
            <tr>
                <td style="font-weight: bold; text-align: right">Total:</td>
                <td colspan="6" style="font-style: italic">0</td>
            </tr>
        </tfoot>
    </table>
</div>
<script type="text/javascript">
    $(function () {
        var container = $('#vhs-projects'),
            loader = container.find('div.loader'),
            table = container.find('table'),
            tableBody = table.find('tbody'),
            username = 'neocotic';
        container.attr('id', container.attr('id') + '-' + gph.random());
        loader.append(gph.loadingImg);
        function addCell(row, contents) {
            return $('<td/>').append(contents).appendTo(row);
        }
        gh.user(username).repos(function (json) {
            var data = {}, i = 0, row = {};
            if (json.repositories.length) {
                json.repositories.sort(function (a, b) {
                    return a.name.toLowerCase().localeCompare(b.name.toLowerCase());
                });
                for (; i < json.repositories.length; i++) {
                    data = json.repositories[i];
                    row = $('<tr/>').appendTo(tableBody);
                    addCell(row, $('<a/>', {
                        'href': data.url,
                        'tabindex': -1,
                        'target': '_blank',
                        'text': data.name
                    }));
                    addCell(row, data.description);
                    addCell(row, $('<a/>', {
                        'href': data.url + '/watchers',
                        'tabindex': -1,
                        'target': '_blank',
                        'text': data.watchers
                    })).css('text-align', 'center');
                    addCell(row, $('<a/>', {
                        'href': data.url + '/network',
                        'tabindex': -1,
                        'target': '_blank',
                        'text': data.forks
                    })).css('text-align', 'center');
                    if (data.has_issues) {
                        addCell(row, $('<a/>', {
                            'href': data.url + '/issues',
                            'tabindex': -1,
                            'target': '_blank',
                            'text': data.open_issues
                        })).css('text-align', 'center');
                    } else {
                        addCell(row, '#').css('text-align', 'center');
                    }
                    if (data.created_at) {
                        addCell(row, $('<abbr/>', {
                            'class': 'relatize',
                            'title': gph.formatDateTime(data.created_at)
                        }));
                    } else {
                        addCell(row, 'never');
                    }
                    if (data.pushed_at) {
                        addCell(row, $('<abbr/>', {
                            'class': 'relatize',
                            'title': gph.formatDateTime(data.pushed_at)
                        }));
                    } else {
                        addCell(row, 'never');
                    }
                }
                table.find('tfoot tr td:last-child').text(json.repositories.length);
            } else {
                tableBody.append($('<tr/>').append($('<td/>', {
                    'colspan': 7,
                    'style': 'font-style: italic',
                    'text': 'No projects found!'
                })));
            }
            $('abbr.relatize').timeago();
            loader.hide();
            table.show();
            gph.scrollTo(container);
        });
    });
</script>